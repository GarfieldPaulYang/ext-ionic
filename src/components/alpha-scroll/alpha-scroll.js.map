{"version":3,"sources":["alpha-scroll.ts"],"names":[],"mappings":"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","file":"alpha-scroll.js","sourceRoot":"","sourcesContent":["import * as _ from 'lodash';\nimport {\n  Component,\n  OnInit,\n  OnChanges,\n  OnDestroy,\n  Host,\n  Input,\n  ElementRef,\n  TemplateRef\n} from '@angular/core';\nimport { Content } from 'ionic-angular';\n\nimport { OrderBy } from '../../pipes/order-by';\n\n\nexport class AlphaScroll implements OnInit, OnChanges, OnDestroy {\n   listData: any;\n   key: string;\n   itemTemplate: TemplateRef<Object>;\n   currentPageClass: any;\n  private letterIndicatorEle: HTMLElement;\n  private indicatorHeight: number;\n  private indicatorWidth: number;\n  private hammer: HammerManager;\n  sortedItems: any = [];\n  alphabet: any = [];\n\n  constructor(private elementRef: ElementRef, private orderBy: OrderBy,  private content: Content) {\n    this.letterIndicatorEle = document.createElement('div');\n    this.letterIndicatorEle.className = 'ion-alpha-letter-indicator';\n    let body = document.getElementsByTagName('body')[0];\n    body.appendChild(this.letterIndicatorEle);\n  }\n\n  ngOnInit() {\n    setTimeout(() => {\n      this.indicatorWidth = this.letterIndicatorEle.offsetWidth;\n      this.indicatorHeight = this.letterIndicatorEle.offsetHeight;\n      this.setupHammerHandlers();\n    });\n  }\n\n  ngOnChanges() {\n    let sortedListData: Array<any> = this.orderBy.transform(this.listData, [this.key]);\n    let groupItems: any = _.groupBy(sortedListData, item => {\n      let letter: any = _.get(item, this.key);\n      return letter.toUpperCase().charAt(0);\n    });\n    this.sortedItems = this.unwindGroup(groupItems);\n    this.alphabet = this.iterateAlphabet(groupItems);\n  }\n\n  ngOnDestroy() {\n    if (this.letterIndicatorEle) {\n      this.letterIndicatorEle.remove();\n    }\n\n    if (this.hammer) {\n      this.hammer.destroy();\n    }\n  }\n\n  setAlphaClass(alpha: any): string {\n    return alpha.isActive ? 'ion-alpha-active' : 'ion-alpha-invalid';\n  }\n\n  calculateDimensionsForSidebar() {\n    return {\n      top: this.content.contentTop + 'px',\n      height: (this.content.getContentDimensions().contentHeight - 28) + 'px'\n    };\n  }\n\n  alphaScrollGoToList(letter: any) {\n    let ele: any = this.elementRef.nativeElement.querySelector(`#scroll-letter-${letter}`);\n    if (ele) {\n      this.content.scrollTo(0, ele.offsetTop);\n    }\n  }\n\n  private setupHammerHandlers() {\n    let sidebarEle: HTMLElement = this.elementRef.nativeElement.querySelector('.ion-alpha-sidebar');\n\n    if (!sidebarEle) return;\n\n    this.hammer = new Hammer(sidebarEle, {\n      recognizers: [\n        [Hammer.Pan, { direction: Hammer.DIRECTION_VERTICAL }],\n      ]\n    });\n\n    this.hammer.on('panstart', (e: any) => {\n      this.letterIndicatorEle.style.top = ((window.innerHeight - this.indicatorHeight) / 2) + 'px';\n      this.letterIndicatorEle.style.left = ((window.innerWidth - this.indicatorWidth) / 2) + 'px';\n      this.letterIndicatorEle.style.visibility = 'visible';\n    });\n\n    this.hammer.on('panend pancancel', (e: any) => {\n      this.letterIndicatorEle.style.visibility = 'hidden';\n    });\n\n    this.hammer.on('panup pandown', _.throttle((e: any) => {\n      let closestEle: any = document.elementFromPoint(e.center.x, e.center.y);\n      if (closestEle && ['LI', 'A'].indexOf(closestEle.tagName) > -1) {\n        let letter = closestEle.innerText;\n        this.letterIndicatorEle.innerText = letter;\n        let letterDivider: any = this.elementRef.nativeElement.querySelector(`#scroll-letter-${letter}`);\n        if (letterDivider) {\n          this.content.scrollTo(0, letterDivider.offsetTop);\n        }\n      }\n    }, 50));\n  }\n\n  private unwindGroup(groupItems: any): Array<any> {\n    let result: Array<any> = [];\n    for (let letter in groupItems) {\n      result = result.concat([{ isDivider: true, letter: letter }].concat(groupItems[letter]));\n    }\n    return result;\n  }\n\n  private iterateAlphabet(alphabet: any): Array<any> {\n    let str: string = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n    let result: Array<any> = [];\n    for (let i = 0; i < str.length; i++) {\n      let letter = str.charAt(i);\n      let isActive = alphabet[letter] ? true : false;\n      result.push({ letter: letter, isActive: isActive });\n    }\n    return result;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'ion-alpha-scroll',\n  template: `\n    <ion-list class=\"ion-alpha-list\">\n      <div *ngFor=\"let item of sortedItems\">\n        <ion-item-divider id=\"scroll-letter-{{item.letter}}\" *ngIf=\"item.isDivider\">{{item.letter}}</ion-item-divider>\n        <ng-template [ngTemplateOutlet]=\"itemTemplate\" [ngOutletContext]=\"{'item': item, 'currentPageClass': currentPageClass}\" *ngIf=\"!item.isDivider\">\n        </ng-template>\n      </div>\n    </ion-list>\n    <ul class=\"ion-alpha-sidebar\" [ngStyle]=\"calculateDimensionsForSidebar()\">\n      <li *ngFor=\"let alpha of alphabet\" [class]=\"setAlphaClass(alpha)\" tappable (click)=\"alphaScrollGoToList(alpha.letter)\">\n        <a>{{alpha.letter}}</a>\n      </li>\n    </ul>\n  `\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: OrderBy, },\n{type: Content, decorators: [{ type: Host }, ]},\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'listData': [{ type: Input },],\n'key': [{ type: Input },],\n'itemTemplate': [{ type: Input },],\n'currentPageClass': [{ type: Input },],\n};\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}