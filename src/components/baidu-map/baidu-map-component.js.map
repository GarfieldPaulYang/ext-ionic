{"version":3,"sources":["baidu-map-component.ts"],"names":[],"mappings":"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","file":"baidu-map-component.js","sourceRoot":"","sourcesContent":["import {\n  Component,\n  AfterViewInit,\n  OnChanges,\n  Input,\n  Output,\n  EventEmitter,\n  ElementRef,\n  SimpleChange,\n  SimpleChanges\n} from '@angular/core';\nimport * as _ from 'lodash';\n\nimport { ConfigProvider } from '../../config/config';\n\nimport { BaiduMapOptions, MarkerOptions } from './baidu-map-options';\nimport { BaiduMapController, BMap } from './baidu-map';\n\n\nexport class BaiduMap implements AfterViewInit, OnChanges {\n   options: BaiduMapOptions;\n\n   onMapLoaded: EventEmitter<void> = new EventEmitter<void>();\n   onMapLoadFialed: EventEmitter<any> = new EventEmitter<any>();\n   onMapClick: EventEmitter<any> = new EventEmitter<any>();\n   onMarkerClick: EventEmitter<any> = new EventEmitter<any>();\n\n  private opacity: number = 0;\n  private mapLoaded: boolean = false;\n\n  constructor(\n    private _elementRef: ElementRef,\n    private baiduMapCtrl: BaiduMapController,\n    private config: ConfigProvider\n  ) { }\n\n  ngAfterViewInit() {\n    let opts: BaiduMapOptions = this.getOptions();\n    this.baiduMapCtrl.init(\n      opts,\n      this._elementRef.nativeElement\n    ).then(() => {\n      this.baiduMapCtrl.addEventListener('click', this.onMapClick);\n      this.reDraw(opts);\n      this.onMapLoaded.emit();\n      this.mapLoaded = true;\n    }, e => {\n      this.opacity = 1;\n      this.onMapLoadFialed.emit(e);\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (!this.mapLoaded) {\n      return;\n    }\n\n    let options: SimpleChange = changes['options'];\n    if (options.isFirstChange) {\n      return;\n    }\n\n    if (options && !_.isEqual(options.previousValue, options.currentValue)) {\n      this.reDraw(this.getOptions());\n    }\n  }\n\n  private reDraw(opts: BaiduMapOptions) {\n    this.baiduMapCtrl.panTo(new BMap.Point(opts.center.lng, opts.center.lat));\n    this.draw(opts.markers);\n  }\n\n  private draw(markers: Array<MarkerOptions>) {\n    let opts: BaiduMapOptions = this.getOptions();\n    if (opts.mass.enabled) {\n      this.baiduMapCtrl.drawMassPoints(markers, opts.mass.options, this.onMarkerClick);\n      return;\n    }\n    this.baiduMapCtrl.drawMarkers(markers, this.onMarkerClick);\n  }\n\n  private getOptions(): BaiduMapOptions {\n    return { ...this.config.get().baiduMap, ...this.options };\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'ion-baidu-map',\n  template: `\n    <div class=\"offlinePanel\" [style.opacity]=\"opacity\">\n      <label>唉呀，网络出问题了</label>\n    </div>\n  `\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: BaiduMapController, },\n{type: ConfigProvider, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'options': [{ type: Input },],\n'onMapLoaded': [{ type: Output },],\n'onMapLoadFialed': [{ type: Output },],\n'onMapClick': [{ type: Output },],\n'onMarkerClick': [{ type: Output },],\n};\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}